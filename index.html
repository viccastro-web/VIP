<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pagamento Confirmado</title>

  <!-- Meta Pixel -->
  <script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)
  }(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');

  fbq('init', '818826874479120');
  fbq('track', 'PageView');

  /* ==========================
     EVENTO ÃšNICO COM DEDUP
  ========================== */

  if (!sessionStorage.getItem('evento_pagamento_enviado')) {

    const eventId = 'pc_' + Date.now();

    // ðŸ”µ Pixel (Browser)
    fbq('trackCustom', 'PagamentoConfirmado', {
      value: 19.97,
      currency: 'BRL'
    }, {
      eventID: eventId
    });

    // ðŸ”´ CAPI (Servidor via n8n)
    fetch('https://n8n.srv1211783.hstgr.cloud/webhook/meta-capi', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        event_name: 'PagamentoConfirmado',
        value: 19.97,
        currency: 'BRL',
        event_id: eventId
      })
    });

    sessionStorage.setItem('evento_pagamento_enviado', 'true');
  }
  </script>

  <noscript>
    <img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=818826874479120&ev=PagamentoConfirmado&cd[value]=19.97&cd[currency]=BRL&noscript=1"/>
  </noscript>

  <style>
    *{
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    body{
      min-height: 100vh;
      background: linear-gradient(180deg, #0f0f0f 0%, #1a1a1a 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
    }

    .container{
      width: 100%;
      max-width: 420px;
      background: #111;
      border-radius: 18px;
      padding: 28px 22px 32px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      text-align: center;
    }

    .avatar{
      width: 140px;
      height: 140px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #ff2e63;
      margin: 0 auto 18px;
      display: block;
    }

    h1{
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .status{
      font-size: 14px;
      color: #9affb5;
      margin-bottom: 18px;
    }

    .description{
      font-size: 15px;
      line-height: 1.45;
      color: #d0d0d0;
      margin-bottom: 26px;
    }

    .cta{
      width: 100%;
      padding: 16px;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      background: linear-gradient(90deg, #ff2e63, #ff6a00);
      color: #fff;
    }
  </style>
</head>

<body>

  <div class="container">
    <img class="avatar"
      src="https://viccastro-web.github.io/viccastro-Chat/avatar.jpg"
      alt="Perfil"
    />

    <h1>Pagamento Confirmado</h1>
    <div class="status">Acesso liberado</div>

    <p class="description">
      Seu pagamento foi confirmado com sucesso.
    </p>

    <button class="cta" onclick="window.location.href='https://t.me/+XJbSkVdj38BiMmNh'">
      Entrar no Grupo VIP
    </button>
  </div>

</body>
</html>
